jobs:
  build-and-test:
    runs-on: macos-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v3

      - name: Set Xcode Version
        run: sudo xcode-select -s /Applications/Xcode_16.2.app

      - name: Install Simulators
        run: |
          xcrun simctl create "iPhone 14" com.apple.CoreSimulator.SimDeviceType.iPhone-14 com.apple.CoreSimulator.SimRuntime.iOS-17-0

      - name: Verify Environment
        run: xcrun simctl list

      - name: Install Ruby dependencies
        run: |
          gem install bundler
          bundle install  --gemfile=./CD/Gemfile

      - name: Run Fastlane
        run: bundle exec fastlane fast_tests



